#include <p18f4520.h>

#pragma config OSC = HS        
#pragma config PWRT = OFF     
#pragma config WDT = OFF       
#pragma config LVP = OFF       
#pragma config DEBUG = OFF    

void lcdcmd(unsigned char);
void lcddata(unsigned char);
void lcdinit(void);
void lcddisplay(int row, unsigned char *str);
void delay(unsigned int value);

#define ldata PORTB             
#define rs PORTDbits.RD3        
#define rw PORTDbits.RD4       
#define en PORTDbits.RD5      

unsigned char text1[] = {" LOGSUN SYSTEMS"};
unsigned char text2[] = {"  PIC 18F4520"};

void main(void)
{
    TRISB = 0x00;       
    TRISD = 0x00;      
    ADCON1 = 0x0F;      
    PORTB = 0x00;
    PORTD = 0x00;

    lcdinit();          
    lcddisplay(1, text1); 
    lcddisplay(2, text2); 

    while(1);           
}

void lcdinit(void)
{
    lcdcmd(0x38);   
    delay(1);
    lcdcmd(0x0E);   
    delay(1);
    lcdcmd(0x01);   
    delay(1);
    lcdcmd(0x06);   
    delay(1);
}

void lcdcmd(unsigned char value)
{
    ldata = value;
    rs = 0;          
    rw = 0;         
    en = 1;         
    delay(1);
    en = 0;
}

void lcddata(unsigned char value)
{
    ldata = value;   
    rs = 1;          
    rw = 0;          
    en = 1;         
    delay(1);
    en = 0;
}

void lcddisplay(int row, unsigned char *str)
{
    int k;
    if(row == 1)
        lcdcmd(0x80);  
    else
        lcdcmd(0xC0); 

    for(k = 0; k < 16; k++)
    {
        if(str[k] != 0)
            lcddata(str[k]);
        else
            break;
    }
}

void delay(unsigned int value)
{
    unsigned int i, j;
    for(i = 0; i < value; i++)
        for(j = 0; j < 50; j++);
}
